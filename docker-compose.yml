services:
  asymptotic_zero:
    image: ghcr.io/johanespao/asymptotic_zero:latest
    container_name: asymptotic_zero

    # Restart automatically unless manually stopped (survives VPS reboots).
    # Orderly daily restarts at 07:00 WIB are handled by the at-job scheduler
    # written by GitHub Actions on every deploy.
    restart: unless-stopped

    # All runtime secrets come from the .env file written by GitHub Actions
    env_file:
      - .env

    environment:
      - PYTHONUNBUFFERED=1
      - TF_CPP_MIN_LOG_LEVEL=2
      - TF_ENABLE_ONEDNN_OPTS=0

    # Run as the same uid/gid as the VPS user (jpao = 1001) so the mounted
    # logs volume is always writable without manual chown on the host.
    user: "1001:1001"

    # Persist log files on VPS between container restarts / image updates
    volumes:
      - ./logs:/app/logs

    # TTY enabled so Rich dashboard renders correctly when attaching.
    # Attach with: docker attach asymptotic_zero
    # Detach without stopping: Ctrl+P then Ctrl+Q
    stdin_open: true
    tty: true
